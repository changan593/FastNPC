{% set done = status == 'done' %}
<div class="progress-wrap" hx-get="/progress/{{ task_id }}" hx-trigger="load delay:500ms, every 1s" hx-swap="outerHTML">
  <progress value="{{ progress }}" max="100"></progress>
  <div class="status">{{ message }} ({{ progress }}%) · 用时 {{ elapsed_text or '00:00' }}</div>
  {% if done %}
    <div class="mt-2">
      <button hx-get="/structured/view?role={{ role or '' }}" hx-target="#editor" hx-swap="innerHTML">
        查看并编辑结构化数据
      </button>
      <script>document.getElementById('chat-role') && (document.getElementById('chat-role').value = '{{ role or '' }}');</script>
    </div>
  {% endif %}
</div>


